### data points from sampling
modern <- read.csv("data/Striga_GPS_sequenced.csv", header=T)
### data points from sampling
modern <- read.csv("Fig1_mapxPCoA/data/Striga_GPS_sequenced.csv", header=T)
labs <- read.csv('Striga_GPS_sequenced.csv', header = T)
labs <- read.csv('Fig1_mapxPCoA/data/Striga_GPS_sequenced.csv', header = T)
labs$Site <- as.factor(str_replace(labs$Site, "2","") %>% str_trim())
library(tidyverse)
library(pheatmap)
kin <- read.table('ALL.dist', skip = 2)
kin <- read.table('Fig2_kinship/data/ALL.dist', skip = 2)
kin <- as.matrix(kin[,-1])
labs <- read.csv('Fig1_mapxPCoA/data/Striga_GPS_sequenced.csv', header = T)
labs$Site <- as.factor(str_replace(labs$Site, "2","") %>% str_trim())
rownames(kin) <- as.factor(labs$SampleID)
colnames(kin) <- as.factor(labs$SampleID)
library(tidyverse)
library(cowplot)
library(tidyverse)
library(pheatmap)
kin <- read.table('Fig2_kinship/data/ALL.dist', skip = 2)
kin <- as.matrix(kin[,-1])
labs <- read.csv('Fig1_mapxPCoA/data/Striga_GPS_sequenced.csv', header = T)
labs$Site <- as.factor(str_replace(labs$Site, "2","") %>% str_trim())
rownames(kin) <- as.factor(labs$SampleID)
colnames(kin) <- as.factor(labs$SampleID)
head(kin)
kin["SH009"]
kin["SH009",]
min(kin)
max(kin)
sort(kin)
sort(kin) %>% tail()
max(kin)
?pheatmap
citation(pheatmap)
citation("pheatmap")
p <- pheatmap(kin, color = magma(100), annotation_col = host_df, annotation_row = site_df, show_rownames = F, border_color = NA,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
library(viridis)
p <- pheatmap(kin, color = magma(100), annotation_col = host_df, annotation_row = site_df, show_rownames = F, border_color = NA,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
kin <- read.table('Fig2_kinship/data/ALL.dist', skip = 2)
kin <- as.matrix(kin[,-1])
labs <- read.csv('Fig1_mapxPCoA/data/Striga_GPS_sequenced.csv', header = T)
labs$Site <- as.factor(str_replace(labs$Site, "2","") %>% str_trim())
rownames(kin) <- as.factor(labs$SampleID)
colnames(kin) <- as.factor(labs$SampleID)
### for annotations
host_df = data.frame(as.factor("Host" = labs$Host))
rownames(host_df) = rownames(kin)
site_df = data.frame(as.factor("Site" = labs$Site))
rownames(site_df) = rownames(kin)
kin <- read.table('Fig2_kinship/data/ALL.dist', skip = 2)
kin <- as.matrix(kin[,-1])
labs <- read.csv('Fig1_mapxPCoA/data/Striga_GPS_sequenced.csv', header = T)
labs$Site <- as.factor(str_replace(labs$Site, "2","") %>% str_trim())
rownames(kin) <- as.factor(labs$SampleID)
colnames(kin) <- as.factor(labs$SampleID)
### for annotations
host_df = data.frame(as.factor("Host" = labs$Host))
rownames(host_df) = rownames(kin)
labs
head(labs)
### for annotations
host_df = data.frame(as.factor("Host" = labs$Host))
rownames(host_df) = rownames(kin)
### for annotations
host_df = as.data.frame(as.factor("Host" = labs$Host))
### for annotations
host_df = as.data.frame(as.factor(Host = labs$Host))
### for annotations
host_df = data.frame(("Host" = labs$Host))
rownames(host_df) = rownames(kin)
site_df = data.frame(as.factor("Site" = labs$Site))
site_df = data.frame("Site" = labs$Site)
str(site_df)
rownames(site_df) = rownames(kin)
ann_colors <- list(Host = c('finger millet' = "#1B9E77", maize = "aquamarine", sorghum = "plum", sugarcane = "darkorchid"),
Site = c(Chemelil= "#628395", 'Homa Bay' = "#C5D86D", Kibos ="#DB2763", Kisii = "#17377A", Muhoroni ="#FC471E", Mumias ="#55DDE0"))
p <- pheatmap(kin, color = magma(100), annotation_col = host_df, annotation_row = site_df, show_rownames = F, border_color = NA,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
ann_colors <- list(Host = c('finger millet' = "#1B9E77", maize = "aquamarine", sorghum = "plum", sugarcane = "darkorchid"),
Site = c(Chemelil= "#628395", 'Homa Bay' = "#C5D86D", Kibos ="#DB2763", Kisii = "#17377A", Muhoroni ="#FC471E", Mumias ="#55DDE0"))
p <- pheatmap(kin, color = magma(100), annotation_col = host_df, annotation_row = site_df, show_rownames = F, border_color = NA,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
p
ann_colors
site_df
ann_colors
host_df
kin <- read.table('Fig2_kinship/data/ALL.dist', skip = 2)
kin <- as.matrix(kin[,-1])
labs <- read.csv('Fig1_mapxPCoA/data/Striga_GPS_sequenced.csv', header = T)
labs$Site <- as.factor(str_replace(labs$Site, "2","") %>% str_trim())
rownames(kin) <- as.factor(labs$SampleID)
colnames(kin) <- as.factor(labs$SampleID)
### for annotations
host_df = data.frame("Host" = labs$Host)
rownames(host_df) = rownames(kin)
site_df = data.frame("Site" = labs$Site)
rownames(site_df) = rownames(kin)
host_df
ann_colors <- list(Host = c('finger millet' = "#1B9E77", maize = "aquamarine", sorghum = "plum", sugarcane = "darkorchid"),
Site = c(Chemelil= "#628395", 'Homa Bay' = "#C5D86D", Kibos ="#DB2763", Kisii = "#17377A", Muhoroni ="#FC471E", Mumias ="#55DDE0"))
p <- pheatmap(kin, color = magma(100), annotation_col = host_df, annotation_row = site_df, show_rownames = F, border_color = NA,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
p
#install and load libraries
library(tidyverse)
library(reshape2)
library(jcolors)
####load and reformat data
ken <- read.csv('Fig3_germination/Tian_project6.25.19.csv', header=T)
ken$percent <- ken$Germinated/(ken$Germinated+ken$Ungerminated)*100 #make a column for percent germination
ken <- subset(ken, Germinated+Ungerminated > 10)
ken2 <- ken %>% group_by(Sample, Site, Host, Treatment) %>% summarize(germ=mean(percent, na.rm=TRUE), num=n()) #get averages for 3 replicates of each treatment/parasite genotype combination
ken2 <- as.data.frame(ken2) #change to dataframe from tibble format
ken.pos <- subset(ken2, Site == "Kisii" | Site=="HomaBay") #subset to remove positive and negative controls before plotting
df <- dcast(ken.pos, Sample + Site + Host ~ Treatment, value.var="germ") #reformat data frame for easier plotting
colnames(df)[4] <- "DS" #ggplot didn't like column names that start with numbers
df$Site <- droplevels(df)$Site #get rid of unused levels for nicer legend
df <- subset(df, Sample != "Sther143") #only one replicate for one of the treatments
df <- subset(df, Sample != "Sther139") #less than 10 seeds in all wells for one of the treatments
df
df %>% filter(Host == "Finger Millet")
df %>% filter(Host == "FingerMillet")
####load and reformat data
ken <- read.csv('Fig3_germination/Tian_project6.25.19.csv', header=T)
ken$percent <- ken$Germinated/(ken$Germinated+ken$Ungerminated)*100 #make a column for percent germination
ken <- subset(ken, Germinated+Ungerminated > 10)
ken
ken %>% filter(Host == "FingerMillet")
ken %>% filter(Host == "FingerMillet" && Treatment == "5DO")
ken %>% filter(Host == "FingerMillet" && Treatment == "5DS")
ken %>% filter(Host == "FingerMillet" & Treatment == "5DS")
