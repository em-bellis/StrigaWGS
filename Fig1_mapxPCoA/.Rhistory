family = 'binomial') # p < 0.01
anova(mod6, mod4, test = "Chisq")
mod6 <- glmer(cbind(Germinated, Ungerminated) ~ Host + (1|Sample),
data = ken3.pos,
family = 'binomial') # p < 0.01
anova(mod6, mod4, test = "Chisq")
anova(mod6, mod5, test = "Chisq")
mod4
anova(mod2, mod5, test = "Chisq")
anova(mod4, mod5, test = "Chisq")
mod6 <- glmer(cbind(Germinated, Ungerminated) ~ Site + (1|Sample),
data = ken3.pos,
family = 'binomial') # p < 0.01
anova(mod4, mod6, test = "Chisq")
summary(mod5)
summary(mod6)
summary(mod4)
plot(mod4)
qplot(mod4)
plot(mod4)
summary(mod4)
version()
version
anova(mod3, mod4, test = "Chisq")
anova(mod1, mod4, test = "Chisq")
mod1
mod4
summary(mod4)
summary(mod1)
#install and load libraries
library(tidyverse)
library(reshape2)
library(jcolors)
####load and reformat data
ken <- read.csv('Tian_project6.25.19.csv', header=T)
ken$percent <- ken$Germinated/(ken$Germinated+ken$Ungerminated)*100 #make a column for percent germination
ken <- subset(ken, Germinated+Ungerminated > 10)
ken2 <- ken %>% group_by(Sample, Site, Host, Treatment) %>% summarize(germ=mean(percent, na.rm=TRUE), num=n()) #get averages for 3 replicates of each treatment/parasite genotype combination
ken2 <- as.data.frame(ken2) #change to dataframe from tibble format
ken.pos <- subset(ken2, Site == "Kisii" | Site=="HomaBay") #subset to remove positive and negative controls before plotting
df <- dcast(ken.pos, Sample + Site + Host ~ Treatment, value.var="germ") #reformat data frame for easier plotting
colnames(df)[4] <- "DS" #ggplot didn't like column names that start with numbers
df$Site <- droplevels(df)$Site #get rid of unused levels for nicer legend
df <- subset(df, Sample != "Sther143") #only one replicate for one of the treatments
df <- subset(df, Sample != "Sther139") #less than 10 seeds in all wells for one of the treatments
####make plot
p1 <- ggplot(df, aes(x=DS, y=ORO, col=Site, pch = Host)) +
geom_point(size = 2.5, alpha = 0.8) +
geom_abline(intercept = 0, slope=1, lty=2) +
theme_classic() +
xlab("Germination % \n5DS") +
ylab("Germination % \nORO") +
scale_color_manual(values = paste0(jcolors(palette="pal5"))[c(2,4)], labels = c("Homa Bay", "Kisii")) +
scale_shape_discrete(labels = c("finger millet", "maize", "sorghum"))
p1
####perform stats to see if Germination rates to different hormones are statistically different between parasites from different sites or collected from different hosts
hist(df$DS-df$ORO) #not normally distributed. If you have time can look into other methods for analysis
# ken3
ken3 <- ken %>% group_by(Sample, Site, Host, Treatment)
ken3.pos <- subset(ken3, Site == "Kisii" | Site=="HomaBay") #subset to remove positive and negative controls before plotting
ken3.pos$Host <- as.factor(ken3.pos$Host)
ken3.pos$Treatment <- as.factor(ken3.pos$Treatment)
ken3.pos$Site <- as.factor(ken3.pos$Site)
# glmm with random effect of sample
library(lme4)
mod1 <- glmer(cbind(Germinated, Ungerminated) ~ Site + Host + Treatment + (1|Sample),
data = ken3.pos,
family = 'binomial')
mod2 <- glmer(cbind(Germinated, Ungerminated) ~ Site + Host  + (1|Sample),
data = ken3.pos,
family = 'binomial') # p = 0.004
mod3 <- glmer(cbind(Germinated, Ungerminated) ~ Treatment + Host  + (1|Sample),
data = ken3.pos,
family = 'binomial') # p = 0.011
mod4 <- glmer(cbind(Germinated, Ungerminated) ~ Site + Treatment  + (1|Sample),
data = ken3.pos,
family = 'binomial') # p = 0.24
####### keep treatment and site but not host
mod5 <- glmer(cbind(Germinated, Ungerminated) ~ Treatment  + (1|Sample),
data = ken3.pos,
family = 'binomial') # p = 0.05 to keep site
mod6 <- glmer(cbind(Germinated, Ungerminated) ~ Site + (1|Sample),
data = ken3.pos,
family = 'binomial') # p < 0.01 to keep treatment
summary(mod4)
mod3 <- glmer(cbind(Germinated, Ungerminated) ~ Treatment + Host  + (1|Sample),
data = ken3.pos,
family = 'binomial') # p = 0.011
mod3 <- glmer(cbind(Germinated, Ungerminated) ~ Treatment * Host  + (1|Sample),
data = ken3.pos,
family = 'binomial') # p = 0.011
summary(mod3)
ken4 <- subset(ken3, Site == "Kisii")
ken4 <- subset(ken3.pos, Site == "Kisii")
ken4
mod3 <- glmer(cbind(Germinated, Ungerminated) ~ Treatment * Host  + (1|Sample),
data = ken4,
family = 'binomial') # p = 0.011
summary(mod3)
ken4 <- subset(ken3.pos, Site == "Homa Bay")
mod3 <- glmer(cbind(Germinated, Ungerminated) ~ Treatment * Host  + (1|Sample),
data = ken4,
family = 'binomial') # p = 0.011
ken4
ken4 <- subset(ken3.pos, Site == "HomaBay")
ken4
mod3 <- glmer(cbind(Germinated, Ungerminated) ~ Treatment * Host  + (1|Sample),
data = ken4,
family = 'binomial') # p = 0.011
summary(mod3)
library(adegenet)
citation('adegenet')
print(citation('adegenet'), bibtex=TRUE)
citation('adegenet')
library(raster)
library(viridis)
library(maps)
library(pals)
library(dplyr)
all <- raster('/Users/ebellis/Desktop/Projects/StigaxSorghum/MacroecologyMS/Fig1/all.CLY250.tif')
maiz <- raster('/Users/ebellis/Desktop/Projects/StigaxSorghum/MacroecologyMS/Fig1/maiz.CLY250.tif')
sorg <- raster('/Users/ebellis/Desktop/Projects/StigaxSorghum/MacroecologyMS/Fig1/sorg.CLY250.tif')
mill <- raster('/Users/ebellis/Desktop/Projects/StigaxSorghum/MacroecologyMS/Fig1/mill.CLY250.tif')
gps <- read.csv('~/Documents/GitHub/StrigaWGS/Fig1_mapxPCoA/Striga_GPS.csv')
head(gps)
cbind(gps$Lat, gps$Lon)
unique(cbind(gps$Lat, gps$Lon))
gps2<- unique(cbind(gps$Lat, gps$Lon))
extract(all, gps2)
extract(gps2, all)
extract(all, gps2)
gps2<- unique(cbind.data.frame(gps$Lon, gps$Lat))
extract(all, gps2)
all_hs <- extract(all, gps2)
mill_hs <- extract(mill, gps2)
mill_hs <- extract(sorg, gps2)
mill_hs <- extract(mill, gps2)
sorg_hs <- extract(sorg, gps2)
maiz_hs <- extract(maiz, gps2)
cbind.data.frame(all_hs, mill_hs, sorg_hs, maiz_hs)
gps
filter(gps, Site == "Kisii" | Site=="Homa Bay")
filter(gps, Site == "Kisii" | Site=="Homa Bay" | Site=="Homa Bay 2")
filter(gps, Site == "Kisii" | Site=="Homa Bay" | Site=="Homa Bay 2") %>% unique()
filter(gps, Site == "Kisii" | Site=="Homa Bay" | Site=="Homa Bay 2") %>% select(c(Lon, Lat) %>% unique()
)
filter(gps, Site == "Kisii" | Site=="Homa Bay" | Site=="Homa Bay 2") %>% select(c(Lon, Lat)) %>% unique()
filter(gps, Site == "Kisii" | Site=="Homa Bay" | Site=="Homa Bay 2") %>% select(Lon, Lat) %>% unique()
filter(gps, Site == "Kisii" | Site=="Homa Bay" | Site=="Homa Bay 2")
filter(gps, Site == "Kisii" | Site=="Homa Bay" | Site=="Homa Bay 2") %>% dplyr::select(Lon, Lat)
filter(gps, Site == "Kisii" | Site=="Homa Bay" | Site=="Homa Bay 2") %>% dplyr::select(Lon, Lat) %>% unique()
coords <- filter(gps, Site == "Kisii" | Site=="Homa Bay" | Site=="Homa Bay 2") %>% dplyr::select(Lon, Lat) %>% unique()
all_hs <- extract(all, coords)
all_hs
mill_hs <- extract(mill, coords)
mill_hs
maiz_hs <- extract(maiz, coords)
mais_hs
maiz_h
maiz_hs
sorg_hs <- extract(sorg, coords)
sorg_hs
gps2
sorg_hs <- extract(sorg, gps2)
sorg_hs
mill_hs <- extract(mill, gps2)
maiz_hs <- extract(maiz, gps2)
sorg_hs
mean(sorg_hs)
mean(mill_hs)
mean(maiz_hs)
setwd("/Users/ebellis/Documents/GitHub/StrigaWGS/")
#setwd("/Users/ebellis/Documents/GitHub/StrigaWGS/")
library(tidyverse)
library(ape)
library(jcolors)
k31 <- read.table("k31.mash.out", header=F)
k31 <- k31 %>% select(1:3)
colnames(k31) <- c("S1","S2","dist")
meta <- read.csv('Fig1_mapxPCoA/Striga_GPS.csv', header=T)
meta$Site <- as.factor(str_replace(meta$Site, "2","") %>% str_trim())
meta <- meta %>% filter(SampleID %in% unique(k31$S1))
k31 <- read.table("k31.mash.out", header=F)
setwd("/Users/ebellis/Documents/GitHub/StrigaWGS/Fig1_mapxPCoA/")
library(tidyverse)
library(ape)
library(jcolors)
k31 <- read.table("k31.mash.out", header=F)
k31 <- k31 %>% select(1:3)
colnames(k31) <- c("S1","S2","dist")
gead(k31)
library(adegenet)
library(tidyverse)
k31 <- read.table("k31.mash.out", header=F)
k31 <- k31 %>% dplyr::select(1:3)
colnames(k31) <- c("S1","S2","dist")
k31$S1 <- as.factor(k31$S1)
k31$S2 <- as.factor(k31$S2)
k31_df <- k31
k31 <- as.matrix(k31 %>%
pivot_wider(names_from = S2,
values_from = dist) %>%
column_to_rownames(var="S1"))
k31.dist <- as.dist(k31)
library(geodist)
modern <- read.csv("../Fig1/Striga_GPS.csv", header=T)
modern <- modern %>% dplyr::select(SampleID, Lat, Lon)
modern <- modern %>% filter(SampleID %in% unique(rownames(k31)))
library(geodist)
modern <- read.csv("Striga_GPS.csv", header=T)
modern <- modern %>% dplyr::select(SampleID, Lat, Lon)
modern <- modern %>% filter(SampleID %in% unique(rownames(k31)))
geomat <- geodist(modern, sequential = F, measure = "geodesic")/1000
rownames(geomat) <- modern$SampleID
colnames(geomat) <- modern$SampleID
geomat_mat <- geomat
geomat <- as.dist(geomat)
ibd <- mantel.randtest(k31.dist,geomat)
plot(ibd) # significant IBD, p=0.003
k31_df$Same_host <- 'N'
k31_df$km <- 'N'
modern <- read.csv("../Fig1/Striga_GPS.csv", header=T)
for (i in 1:nrow(k31_df)) {
if (modern[modern$SampleID == k31_df$S1[i],3] ==
modern[modern$SampleID == k31_df$S2[i],3]) {
k31_df$Same_host[i] <- 'Y'
}
k31_df$km[i] <- geomat_mat[k31_df$S1[i],k31_df$S2[i]]
}
k31_df$km <- as.numeric(k31_df$km)
p <- ggplot(k31_df, aes(x = km, y = dist)) +
geom_point(alpha = 0.1) +
ylim(c(0.02, 0.030)) +
geom_smooth(method='lm', se = F, lty = 2) +
theme_classic() +
xlab("Geographic distance (km)") +
ylab("Genetic distance") +
facet_grid(.~Same_host)# these are the self comparisons
p
same_pop <- subset(k31_df, km == 0 & S1 != S2)
diff_pop <- subset(k31_df, km >= 100 & S1 != S2)
quantile(same_pop$dist)
quantile(diff_pop$dist)
mod1 <- lm(dist ~ km, data = k31_df)
mod1
summary(mod1)
kin <- read.table('ALL.dist', header = F)
kin <- read.table('ALL.dist')
?read.table
kin <- read.table('ALL.dist', skip = 2)
head(kin)
heatmap(kin)
kin2 <- as.matrix(kin)
head(kin2)
kin2 <- as.matrix(kin, row.names = [1,])
kin2 <- as.matrix(kin, row.names = 1)
head(kin2)
kin2 <- as.matrix(kin, row.names = V1)
head(kin2)
kin[-1,]
kin[,-1]
as.matrix(kin[,-1])
heatmap(as.matrix(kin[,-1]))
?heatmap
heatmap(as.matrix(kin[,-1]))
labs <- read.csv('Striga_GPS_sequenced.csv', header = T)
head(labs)
ggplot(kin) + geom_tile()
ggplot2(kin) + geom_tile()
?heatmap
heatmap(as.matrix(kin[,-1]), Rowv=F)
?heatmap
heatmap(as.matrix(kin[,-1]), Rowv=NA)
heatmap(as.matrix(kin[,-1]), Rowv=NA, Colv = NA)
?heatmap
heatmap(as.matrix(kin[,-1]), Rowv=NA, Colv = NA, revC = T)
?heatmap
?heatmap
heatmap(as.matrix(kin[,-1]), Rowv=NA, Colv = NA, revC = T)
library(pheatmap)
kin <- as.matrix(kin[,-1])
head(labs)
labs$SampleID
as.factor(labs$SampleID)
rownames(kin) <- as.factor(labs$SampleID)
pheatmap(kin,main = "pheatmap default")
pheatmap(kin, cluster_cols = F, cluster_rows = F)
pheatmap(kin)
colnames(kin) <- as.factor(labs$SampleID)
pheatmap(kin)
pheatmap(kin, annotation_row = labs$Host)
nrow(labs$Host)
labs
df(labs)
dim(labs)
host_df = data.frame("Host" = labs$Host)
pheatmap(kin, annotation_row = host_df)
pheatmap(kin, annotation_row = host_df)
host_df
rownames(host_df) = rownames(kin)
pheatmap(kin, annotation_row = host_df)
site_df = data.frame("Site" = labs$Site)
rownames(site_df) = rownames(kin)
pheatmap(kin, annotation_row = host_df)
pheatmap(kin, annotation_row = host_df, annotation_col = site_df)
labs$Site <- as.factor(str_replace(labs$Site, "2","") %>% str_trim())
library(tidyverse)
labs$Site <- as.factor(str_replace(labs$Site, "2","") %>% str_trim())
library(tidyverse)
library(pheatmap)
kin <- read.table('ALL.dist', skip = 2)
kin <- as.matrix(kin[,-1])
labs <- read.csv('Striga_GPS_sequenced.csv', header = T)
labs$Site <- as.factor(str_replace(labs$Site, "2","") %>% str_trim())
rownames(kin) <- as.factor(labs$SampleID)
colnames(kin) <- as.factor(labs$SampleID)
### for annotations
host_df = data.frame("Host" = labs$Host)
rownames(host_df) = rownames(kin)
site_df = data.frame("Site" = labs$Site)
rownames(site_df) = rownames(kin)
pheatmap(kin, annotation_row = host_df, annotation_col = site_df)
pheatmap(kin, annotation_row = host_df, annotation_col = site_df, cutree_rows = 4)
?pheatmap
pheatmap(kin, annotation_row = host_df, annotation_col = site_df, cutree_rows = 4, border_color = NA)
?pheatmap
pheatmap(kin, annotation_row = host_df, annotation_col = site_df, cutree_rows = 4, border_color = NA, show_rownames = F)
pheatmap(kin, annotation_row = host_df, annotation_col = site_df, cutree_rows = 4, show_rownames = F)
pheatmap(kin, annotation_row = host_df, annotation_col = site_df, cutree_rows = 4, show_rownames = F, width = 2)
pheatmap(kin, annotation_row = host_df, annotation_col = site_df, cutree_rows = 2, show_rownames = F, width = 2)
pheatmap(kin, annotation_row = host_df, annotation_col = site_df, cutree_rows = 2, show_rownames = F, width = 3)
pheatmap(kin, annotation_row = host_df, annotation_col = site_df, cutree_rows = 3, show_rownames = F)
pheatmap(kin, annotation_row = host_df, annotation_col = site_df, cutree_rows = 4, show_rownames = F)
pheatmap(kin, annotation_row = host_df, annotation_col = site_df, cutree_rows = 4, show_rownames = F, border_color = NA)
pheatmap(kin, annotation_row = host_df, annotation_col = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4)
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4)
RColorBrewer::brewer.pal(10, Set3)
RColorBrewer::brewer.pal(10, "Set3")
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4, annotation_colors = RColorBrewer::brewer.pal(10, "Set3"))
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4, annotation_colors = RColorBrewer::brewer.pal(4, "Set3"))
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4, annotation_colors = RColorBrewer::brewer.pal("Set3"))
?pheatmap
Site = c(RColorBrewer::brewer.pal("Set3")[5:10]))
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors =list(Host = c(RColorBrewer::brewer.pal("Set3")[1:4]),
Site = c(RColorBrewer::brewer.pal("Set3")[5:10]))
)
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4, annotation_colors = RColorBrewer::brewer.pal("Set3"))
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors =list(Host = c(RColorBrewer::brewer.pal("Set3")[1:4]),
Site = c(RColorBrewer::brewer.pal("Set3")[5:10]))
)
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors =list(Host = c(RColorBrewer::brewer.pal(10, "Set3")[1:4]),
Site = c(RColorBrewer::brewer.pal(10, "Set3")[5:10]))
)
unique(host_df$Host)
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors =list(Host = c(RColorBrewer::brewer.pal(10, "Set3")[1:4]),
Site = c(RColorBrewer::brewer.pal(10, "Set3")[5:10]))
)
### for annotations
host_df = data.frame(as.factor("Host" = labs$Host))
rownames(host_df) = rownames(kin)
site_df = data.frame(as.factor("Site" = labs$Site))
rownames(site_df) = rownames(kin)
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors =list(Host = c(RColorBrewer::brewer.pal(10, "Set3")[1:4]),
Site = c(RColorBrewer::brewer.pal(10, "Set3")[5:10]))
)
ann_colors <- list(Host = c(RColorBrewer::brewer.pal(10, "Set3")[1:4]),
)
ann_colors <- list(Host = c(RColorBrewer::brewer.pal(10, "Set3")[1:4]),
)
RColorBrewer::brewer.pal(10, "Set3")[1:4]
list(RColorBrewer::brewer.pal(10, "Set3")[1:4])
ann_colors <- list(Host = c(RColorBrewer::brewer.pal(10, "Set3")[1:4]), Site = c(RColorBrewer::brewer.pal(10, "Set3")[5:10]))
annotation_colors = ann_colors
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors)
RColorBrewer::brewer.pal(10, "Set3")
RColorBrewer::brewer.pal(10, "Set2")
RColorBrewer::brewer.pal(8, "Set2")
host_df
RColorBrewer::brewer.pal(8, "Set2")
site_df %>% unique()
site_df$Site %>% unique()
RColorBrewer::brewer.pal(8, "Set2")
RColorBrewer::brewer.pal(8, "Set2")[3:8]
Host = c(finger millet = "#66C2A5", maize = "#FC8D62", sorghum = "#8DA0CB", sugarcane = "#E78AC3"),
Site = c(Chemelil= "#8DA0CB", Homa Bay ="#E78AC3", Kibos ="#A6D854", Kisii = "#FFD92F", Muhoroni ="#E5C494", Mumias ="#B3B3B3")
ann_colors <- list(
Host = c(finger millet = "#66C2A5", maize = "#FC8D62", sorghum = "#8DA0CB", sugarcane = "#E78AC3"),
Site = c(Chemelil= "#8DA0CB", Homa Bay ="#E78AC3", Kibos ="#A6D854", Kisii = "#FFD92F", Muhoroni ="#E5C494", Mumias ="#B3B3B3")
)
ann_colors <- list(
Host = c(finger millet = "#66C2A5", maize = "#FC8D62", sorghum = "#8DA0CB", sugarcane = "#E78AC3"),
Site = c(Chemelil= "#8DA0CB", Homa Bay ="#E78AC3", Kibos ="#A6D854", Kisii = "#FFD92F", Muhoroni ="#E5C494", Mumias ="#B3B3B3")
)
ann_colors <- list(
Host = c(finger millet = "#66C2A5", maize = "#FC8D62", sorghum = "#8DA0CB", sugarcane = "#E78AC3"),
Site = c(Chemelil= "#8DA0CB", Homa Bay ="#E78AC3", Kibos ="#A6D854", Kisii = "#FFD92F", Muhoroni ="#E5C494", Mumias ="#B3B3B3")
)
ann_colors <- list(Host = c(finger millet = "#66C2A5", maize = "#FC8D62", sorghum = "#8DA0CB", sugarcane = "#E78AC3"),
Site = c(Chemelil= "#8DA0CB", Homa Bay ="#E78AC3", Kibos ="#A6D854", Kisii = "#FFD92F", Muhoroni ="#E5C494", Mumias ="#B3B3B3"))
ann_colors <- list(Host = c('finger millet' = "#66C2A5", 'maize' = "#FC8D62", sorghum = "#8DA0CB", sugarcane = "#E78AC3"),
Site = c(Chemelil= "#8DA0CB", Homa Bay = "#E78AC3", Kibos ="#A6D854", Kisii = "#FFD92F", Muhoroni ="#E5C494", Mumias ="#B3B3B3"))
ann_colors <- list(Host = c('finger millet' = "#66C2A5", maize = "#FC8D62", sorghum = "#8DA0CB", sugarcane = "#E78AC3"),
Site = c(Chemelil= "#8DA0CB", 'Homa Bay' = "#E78AC3", Kibos ="#A6D854", Kisii = "#FFD92F", Muhoroni ="#E5C494", Mumias ="#B3B3B3"))
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors)
RColorBrewer::brewer.pal(8, "Dark2")
RColorBrewer::brewer.pal(4, "Dark2")
ann_colors <- list(Host = c('finger millet' = "#1B9E77", maize = "#D95F02", sorghum = "#7570B3", sugarcane = "#E7298A"),
Site = c(Chemelil= "#8DA0CB", 'Homa Bay' = "#E78AC3", Kibos ="#A6D854", Kisii = "#FFD92F", Muhoroni ="#E5C494", Mumias ="#B3B3B3"))
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors)
ann_colors <- list(Host = c('finger millet' = "#1B9E77", maize = "chartreuse", sorghum = "#7570B3", sugarcane = "#E7298A"),
Site = c(Chemelil= "#8DA0CB", 'Homa Bay' = "#E78AC3", Kibos ="#A6D854", Kisii = "#FFD92F", Muhoroni ="#E5C494", Mumias ="#B3B3B3"))
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors)
ann_colors <- list(Host = c('finger millet' = "#1B9E77", maize = "light green", sorghum = "#7570B3", sugarcane = "#E7298A"),
Site = c(Chemelil= "#8DA0CB", 'Homa Bay' = "#E78AC3", Kibos ="#A6D854", Kisii = "#FFD92F", Muhoroni ="#E5C494", Mumias ="#B3B3B3"))
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors)
ann_colors <- list(Host = c('finger millet' = "#1B9E77", maize = "aquamarine", sorghum = "#7570B3", sugarcane = "#E7298A"),
Site = c(Chemelil= "#8DA0CB", 'Homa Bay' = "#E78AC3", Kibos ="#A6D854", Kisii = "#FFD92F", Muhoroni ="#E5C494", Mumias ="#B3B3B3"))
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors)
RColorBrewer::brewer.pal(4, "Set2")
ann_colors <- list(Host = c('finger millet' = "#1B9E77", maize = "aquamarine", sorghum = "plum", sugarcane = "#E7298A"),
Site = c(Chemelil= "#8DA0CB", 'Homa Bay' = "#E78AC3", Kibos ="#A6D854", Kisii = "#FFD92F", Muhoroni ="#E5C494", Mumias ="#B3B3B3"))
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors)
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F)
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_row = 6)
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_row = 6)
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_row = 2)
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_row = 2)
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 2)
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 5)
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 4.5)
pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
p <- pheatmap(kin, annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
library(viridis)
pheatmap(kin, color = viridis("magma"), annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
pheatmap(kin, color = viridis(10), annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
pheatmap(kin, color = viridis(100), annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
ann_colors <- list(Host = c('finger millet' = "#1B9E77", maize = "aquamarine", sorghum = "plum", sugarcane = "fuschia"),
Site = c(Chemelil= "#8DA0CB", 'Homa Bay' = "#E78AC3", Kibos ="#A6D854", Kisii = "#FFD92F", Muhoroni ="#E5C494", Mumias ="#B3B3B3"))
ann_colors <- list(Host = c('finger millet' = "#1B9E77", maize = "aquamarine", sorghum = "plum", sugarcane = "fuschia4"),
Site = c(Chemelil= "#8DA0CB", 'Homa Bay' = "#E78AC3", Kibos ="#A6D854", Kisii = "#FFD92F", Muhoroni ="#E5C494", Mumias ="#B3B3B3"))
pheatmap(kin, color = viridis(100), annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
ann_colors <- list(Host = c('finger millet' = "#1B9E77", maize = "aquamarine", sorghum = "plum", sugarcane = "fuschia"),
Site = c(Chemelil= "#8DA0CB", 'Homa Bay' = "#E78AC3", Kibos ="#A6D854", Kisii = "#FFD92F", Muhoroni ="#E5C494", Mumias ="#B3B3B3"))
pheatmap(kin, color = viridis(100), annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
ann_colors <- list(Host = c('finger millet' = "#1B9E77", maize = "aquamarine", sorghum = "plum", sugarcane = "darkorchid"),
Site = c(Chemelil= "#8DA0CB", 'Homa Bay' = "#E78AC3", Kibos ="#A6D854", Kisii = "#FFD92F", Muhoroni ="#E5C494", Mumias ="#B3B3B3"))
pheatmap(kin, color = viridis(100), annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
pheatmap(kin, color = magma(100), annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
pdf("FigX_heatmap.pdf", length = 3, width = 6.5)
pdf("FigX_heatmap.pdf", height = 3, width = 6.5)
p
dev.off()
pdf("FigX_heatmap.pdf", height = 4, width = 6.5)
p
dev.off()
p <- pheatmap(kin, color = viridis(100), annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
p
p <- pheatmap(kin, color = plasma(100), annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
p
p <- pheatmap(kin, color = magma(100), annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
p
library(jcolors)
paste0(jcolors(palette="pal5"))
ann_colors <- list(Host = c('finger millet' = "#1B9E77", maize = "aquamarine", sorghum = "plum", sugarcane = "darkorchid"),
Site = c(Chemelil= "#628395", 'Homa Bay' = "#C5D86D", Kibos ="#DB2763", Kisii = "#17377A", Muhoroni ="#FC471E", Mumias ="#55DDE0"))
p <- pheatmap(kin, color = magma(100), annotation_col = host_df, annotation_row = site_df, cutree_rows = 4, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
p
pdf("FigX_heatmap.pdf", height = 4, width = 6.5)
p
dev.off()
p <- pheatmap(kin, color = magma(100), annotation_col = host_df, annotation_row = site_df, show_rownames = F, border_color = NA,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
pdf("FigX_heatmap.pdf", height = 4, width = 6.5)
p
dev.off()
p <- pheatmap(kin, color = magma(100), annotation_col = host_df, annotation_row = site_df, show_rownames = F, border_color = NA,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
p <- pheatmap(kin, color = magma(100), annotation_col = host_df, annotation_row = site_df, cutree_rows = 6, show_rownames = F, border_color = NA, cutree_cols = 4,
annotation_colors = ann_colors, legend = F, fontsize_col = 4)
