annotate("text", x = 180, y = 12.4, label = "0")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.4, label = "0\u00B0")
+
annotate("text", x = 180, y = 13.4, label = "15\u00BN")
+
annotate("text", x = 180, y = 13.4, label = "15\u00B0N")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.4, label = "0\u00B0") +
annotate("text", x = 180, y = 13.4, label = "15\u00B0N")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.4, label = "0\u00B0") +
annotate("text", x = 180, y = 13.2, label = "15\u00B0N")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.3, label = "0\u00B0") +
annotate("text", x = 180, y = 13.2, label = "15\u00B0N")+
annotate("text", x = 180, y = 14.2, label = "30\u00B0N")
df <- rbind.data.frame(cbind(-30, days), cbind(-15, days), cbind(0, days), cbind(15, days), cbind(30, days))
df$daylength <- "NA"
for (i in 1:nrow(df)){
df$daylength[i] <- daylength(df$V1[i], df$days[i])
}
df$daylength <- as.numeric(df$daylength)
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.3, label = "0\u00B0") +
annotate("text", x = 180, y = 13.2, label = "15\u00B0N")+
annotate("text", x = 180, y = 14.3, label = "30\u00B0N")+
annotate("text", x = 180, y = 13.2, label = "45\u00B0N")
df <- rbind.data.frame(cbind(-30, days), cbind(-15, days), cbind(-10, days), cbind(0, days), cbind(10, days), cbind(15, days), cbind(30, days))
df$daylength <- "NA"
for (i in 1:nrow(df)){
df$daylength[i] <- daylength(df$V1[i], df$days[i])
}
df$daylength <- as.numeric(df$daylength)
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.3, label = "0\u00B0") +
annotate("text", x = 180, y = 13.2, label = "15\u00B0N")+
annotate("text", x = 180, y = 14.3, label = "30\u00B0N")+
annotate("text", x = 180, y = 13.2, label = "45\u00B0N")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.2, label = "0\u00B0") +
annotate("text", x = 180, y = 13.2, label = "15\u00B0N")+
annotate("text", x = 180, y = 14.3, label = "30\u00B0N")+
annotate("text", x = 180, y = 112.5, label = "10\u00B0N")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.2, label = "0\u00B0") +
annotate("text", x = 180, y = 13.2, label = "15\u00B0N")+
annotate("text", x = 180, y = 14.3, label = "30\u00B0N")+
annotate("text", x = 180, y = 12.5, label = "10\u00B0N")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.2, label = "0\u00B0") +
annotate("text", x = 180, y = 13.2, label = "15\u00B0N")+
annotate("text", x = 180, y = 14.3, label = "30\u00B0N")+
annotate("text", x = 180, y = 12.8, label = "10\u00B0N")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.2, label = "0\u00B0") +
annotate("text", x = 180, y = 13.0, label = "15\u00B0N")+
annotate("text", x = 180, y = 14.3, label = "30\u00B0N")+
annotate("text", x = 180, y = 12.8, label = "10\u00B0N")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.2, label = "0\u00B0") +
annotate("text", x = 180, y = 13.1, label = "15\u00B0N")+
annotate("text", x = 180, y = 14.2, label = "30\u00B0N")+
annotate("text", x = 180, y = 12.8, label = "10\u00B0N")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.2, label = "0\u00B0") +
annotate("text", x = 180, y = 13.15, label = "15\u00B0N")+
annotate("text", x = 180, y = 14.2, label = "30\u00B0N")+
annotate("text", x = 180, y = 12.8, label = "10\u00B0N")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.25, label = "0\u00B0") +
annotate("text", x = 180, y = 13.15, label = "15\u00B0N")+
annotate("text", x = 180, y = 14.2, label = "30\u00B0N")+
annotate("text", x = 180, y = 12.8, label = "10\u00B0N")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.25, label = "0\u00B0") +
annotate("text", x = 180, y = 13.15, label = "15\u00B0N")+
annotate("text", x = 180, y = 14.2, label = "30\u00B0N")+
annotate("text", x = 180, y = 12.8, label = "10\u00B0N")+
annotate("text", x = 180, y = -13.15, label = "15\u00B0S")+
annotate("text", x = 180, y = -14.2, label = "30\u00B0S")+
annotate("text", x = 180, y = -12.8, label = "10\u00B0S")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.25, label = "0\u00B0") +
annotate("text", x = 180, y = 13.15, label = "15\u00B0N")+
annotate("text", x = 180, y = 14.2, label = "30\u00B0N")+
annotate("text", x = 180, y = 12.8, label = "10\u00B0N")+
annotate("text", x = 180, y = 11.15, label = "15\u00B0S")+
annotate("text", x = 180, y = 11.2, label = "30\u00B0S")+
annotate("text", x = 180, y = 11.8, label = "10\u00B0S")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.25, label = "0\u00B0") +
annotate("text", x = 180, y = 13.15, label = "15\u00B0N")+
annotate("text", x = 180, y = 14.2, label = "30\u00B0N")+
annotate("text", x = 180, y = 12.8, label = "10\u00B0N")+
annotate("text", x = 180, y = 11.15, label = "15\u00B0S")+
annotate("text", x = 180, y = 11.2, label = "30\u00B0S")+
annotate("text", x = 180, y = 11.7, label = "10\u00B0S")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 180, y = 12.25, label = "0\u00B0") +
annotate("text", x = 180, y = 13.15, label = "15\u00B0N")+
annotate("text", x = 180, y = 14.2, label = "30\u00B0N")+
annotate("text", x = 180, y = 12.8, label = "10\u00B0N")+
annotate("text", x = 180, y = 11.15, label = "15\u00B0S")+
annotate("text", x = 180, y = 10.5, label = "30\u00B0S")+
annotate("text", x = 180, y = 11.65, label = "10\u00B0S")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 175, y = 12.25, label = "0\u00B0") +
annotate("text", x = 175, y = 13.15, label = "15\u00B0N")+
annotate("text", x = 175, y = 14.2, label = "30\u00B0N")+
annotate("text", x = 175, y = 12.8, label = "10\u00B0N")+
annotate("text", x = 175, y = 11.15, label = "15\u00B0S")+
annotate("text", x = 175, y = 10.5, label = "30\u00B0S")+
annotate("text", x = 175, y = 11.65, label = "10\u00B0S")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 175, y = 12.25, label = "0\u00B0") +
annotate("text", x = 175, y = 13.15, label = "15\u00B0N")+
annotate("text", x = 175, y = 14.2, label = "30\u00B0N")+
annotate("text", x = 175, y = 12.8, label = "10\u00B0N")+
annotate("text", x = 175, y = 11.15, label = "15\u00B0S")+
annotate("text", x = 175, y = 10.4, label = "30\u00B0S")+
annotate("text", x = 175, y = 11.65, label = "10\u00B0S")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 175, y = 12.25, label = "0\u00B0") +
annotate("text", x = 175, y = 13.15, label = "15\u00B0N")+
annotate("text", x = 175, y = 14.2, label = "30\u00B0N")+
annotate("text", x = 175, y = 12.8, label = "10\u00B0N")+
annotate("text", x = 175, y = 11.5, label = "15\u00B0S")+
annotate("text", x = 175, y = 10.4, label = "30\u00B0S")+
annotate("text", x = 175, y = 11.65, label = "10\u00B0S")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 175, y = 12.25, label = "0\u00B0") +
annotate("text", x = 175, y = 13.15, label = "15\u00B0N")+
annotate("text", x = 175, y = 14.2, label = "30\u00B0N")+
annotate("text", x = 175, y = 12.8, label = "10\u00B0N")+
annotate("text", x = 175, y = 11.4, label = "15\u00B0S")+
annotate("text", x = 175, y = 10.4, label = "30\u00B0S")+
annotate("text", x = 175, y = 11.65, label = "10\u00B0S")
ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 175, y = 12.25, label = "0\u00B0") +
annotate("text", x = 175, y = 13.15, label = "15\u00B0N")+
annotate("text", x = 175, y = 14.2, label = "30\u00B0N")+
annotate("text", x = 175, y = 12.8, label = "10\u00B0N")+
annotate("text", x = 175, y = 11.35, label = "15\u00B0S")+
annotate("text", x = 175, y = 10.4, label = "30\u00B0S")+
annotate("text", x = 175, y = 11.65, label = "10\u00B0S")
p <- ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "blue") +
annotate("text", x = 175, y = 12.25, label = "0\u00B0") +
annotate("text", x = 175, y = 13.15, label = "15\u00B0N")+
annotate("text", x = 175, y = 14.2, label = "30\u00B0N")+
annotate("text", x = 175, y = 12.8, label = "10\u00B0N")+
annotate("text", x = 175, y = 11.35, label = "15\u00B0S")+
annotate("text", x = 175, y = 10.4, label = "30\u00B0S")+
annotate("text", x = 175, y = 11.65, label = "10\u00B0S")
p <- ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "grey") +
annotate("text", x = 175, y = 12.25, label = "0\u00B0") +
annotate("text", x = 175, y = 13.15, label = "15\u00B0N")+
annotate("text", x = 175, y = 14.2, label = "30\u00B0N")+
annotate("text", x = 175, y = 12.8, label = "10\u00B0N")+
annotate("text", x = 175, y = 11.35, label = "15\u00B0S")+
annotate("text", x = 175, y = 10.4, label = "30\u00B0S")+
annotate("text", x = 175, y = 11.65, label = "10\u00B0S")
p
p <- ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .5,fill = "grey") +
annotate("text", x = 175, y = 12.25, label = "0\u00B0") +
annotate("text", x = 175, y = 13.15, label = "15\u00B0N")+
annotate("text", x = 175, y = 14.2, label = "30\u00B0N")+
annotate("text", x = 175, y = 12.8, label = "10\u00B0N")+
annotate("text", x = 175, y = 11.35, label = "15\u00B0S")+
annotate("text", x = 175, y = 10.4, label = "30\u00B0S")+
annotate("text", x = 175, y = 11.65, label = "10\u00B0S")
p
p <- ggplot(df, aes(x=days, y=daylength, group=as.factor(V1))) +
geom_line(lty = 1, col = "black") +
theme_classic() +
xlab("Julian Day") +
ylab("Daylength (hrs)") +
annotate("rect", xmin = 0, xmax = 365, ymin = 11.76864, ymax = 12.47525,
alpha = .2,fill = "black") +
annotate("text", x = 175, y = 12.25, label = "0\u00B0") +
annotate("text", x = 175, y = 13.15, label = "15\u00B0N")+
annotate("text", x = 175, y = 14.2, label = "30\u00B0N")+
annotate("text", x = 175, y = 12.8, label = "10\u00B0N")+
annotate("text", x = 175, y = 11.35, label = "15\u00B0S")+
annotate("text", x = 175, y = 10.4, label = "30\u00B0S")+
annotate("text", x = 175, y = 11.65, label = "10\u00B0S")
p
nrow(df)
nrow(occ.df)
daylength(26.86, 351)
daylength(26.86, 300)
setwd("/Users/ebellis/Documents/GitHub/StrigaWGS/Fig1_mapxPCoA/")
library(tidyverse)
library(ape)
library(jcolors)
k31 <- read.table("k31.mash.out", header=F)
k31 <- k31 %>% select(1:3)
colnames(k31) <- c("S1","S2","dist")
meta <- read.csv('Striga_GPS.csv', header=T)
meta$Site <- as.factor(str_replace(meta$Site, "2","") %>% str_trim())
meta <- meta %>% filter(SampleID %in% unique(k31$S1))
meta_sub <- meta
# create distance matrix
k31_flt <- k31 %>% filter(S1 %in% meta_sub$SampleID) %>%
filter(S2 %in% meta_sub$SampleID)
k31_flt <- as.matrix(k31_flt %>%
pivot_wider(names_from = S2,
values_from = dist) %>%
column_to_rownames(var="S1"))
k31.dist <- as.dist(k31_flt)
# run PCoA
k31.pcoa <- ape::pcoa(k31.dist, correction="none", rn=NULL)
k31.pcoa$values$Broken_stick
k31.pcoa$values$Broken_stick[1:2]
meta_sub <- filter(meta, Site != "Kisii") %>%
filter(Site != "Homa Bay")
meta_subkh <- filter(meta,
SampleID =="SH130"| SampleID =="SH134"|
SampleID =="SH138"| SampleID =="SH139"|
SampleID =="SH146"| SampleID =="SH124"|
SampleID =="SH117"| SampleID =="SH113"|
SampleID =="SH111"|SampleID =="SH104")
meta_sub <- rbind(meta_sub, meta_subkh)
# create distance matrix
k31_flt <- k31 %>% filter(S1 %in% meta_sub$SampleID) %>%
filter(S2 %in% meta_sub$SampleID)
k31_flt <- as.matrix(k31_flt %>%
pivot_wider(names_from = S2,
values_from = dist) %>%
column_to_rownames(var="S1"))
k31.dist <- as.dist(k31_flt)
# run PCoA
k31.pcoa <- ape::pcoa(k31.dist, correction="none", rn=NULL)
k31.pcoa$values$Broken_stick[1:2]
meta_sub <- filter(meta, Site == "Kisii")
# create distance matrix
k31_flt <- k31 %>% filter(S1 %in% meta_sub$SampleID) %>%
filter(S2 %in% meta_sub$SampleID)
k31_flt <- as.matrix(k31_flt %>%
pivot_wider(names_from = S2,
values_from = dist) %>%
column_to_rownames(var="S1"))
k31.dist <- as.dist(k31_flt)
# run PCoA
k31.pcoa <- ape::pcoa(k31.dist, correction="none", rn=NULL)
k31.pcoa$values$Broken_stick[1:2]
ki <- kk31.pcoa
ki <- k31.pcoa
meta_sub <- filter(meta, Site == "Homa Bay")
# create distance matrix
k31_flt <- k31 %>% filter(S1 %in% meta_sub$SampleID) %>%
filter(S2 %in% meta_sub$SampleID)
k31_flt <- as.matrix(k31_flt %>%
pivot_wider(names_from = S2,
values_from = dist) %>%
column_to_rownames(var="S1"))
k31.dist <- as.dist(k31_flt)
# run PCoA
k31.pcoa <- ape::pcoa(k31.dist, correction="none", rn=NULL)
k31.pcoa$values[1:5]
k31.pcoa$values
k31.pcoa$values[1:5,]
ki$values[1:5,]
ki$values
ki$values[1:5,]
k31.pcoa$values[1:5,]
meta_sub <- filter(meta, Site != "Kisii") %>%
filter(Site != "Homa Bay")
meta_subkh <- filter(meta,
SampleID =="SH130"| SampleID =="SH134"|
SampleID =="SH138"| SampleID =="SH139"|
SampleID =="SH146"| SampleID =="SH124"|
SampleID =="SH117"| SampleID =="SH113"|
SampleID =="SH111"|SampleID =="SH104")
meta_sub <- rbind(meta_sub, meta_subkh)
# create distance matrix
k31_flt <- k31 %>% filter(S1 %in% meta_sub$SampleID) %>%
filter(S2 %in% meta_sub$SampleID)
k31_flt <- as.matrix(k31_flt %>%
pivot_wider(names_from = S2,
values_from = dist) %>%
column_to_rownames(var="S1"))
k31.dist <- as.dist(k31_flt)
# run PCoA
k31.pcoa <- ape::pcoa(k31.dist, correction="none", rn=NULL)
k31.pcoa
k31.pcoa$values
k31.pcoa$values[1:5,]
meta_sub <- meta
# create distance matrix
k31_flt <- k31 %>% filter(S1 %in% meta_sub$SampleID) %>%
filter(S2 %in% meta_sub$SampleID)
k31_flt <- as.matrix(k31_flt %>%
pivot_wider(names_from = S2,
values_from = dist) %>%
column_to_rownames(var="S1"))
k31.dist <- as.dist(k31_flt)
# run PCoA
k31.pcoa <- ape::pcoa(k31.dist, correction="none", rn=NULL)
k31.pcoa$values[1:5,]
?pcoa
ki$values[1:5,]
#install and load libraries
library(tidyverse)
library(reshape2)
library(jcolors)
####load and reformat data
ken <- read.csv('Tian_project6.25.19.csv', header=T)
getwd()
setwd("../Fig2_germination/")
####load and reformat data
ken <- read.csv('Tian_project6.25.19.csv', header=T)
ken$percent <- ken$Germinated/(ken$Germinated+ken$Ungerminated)*100 #make a column for percent germination
ken <- subset(ken, Germinated+Ungerminated > 10)
ken2 <- ken %>% group_by(Sample, Site, Host, Treatment) %>% summarize(germ=mean(percent, na.rm=TRUE), num=n()) #get averages for 3 replicates of each treatment/parasite genotype combination
ken2 <- as.data.frame(ken2) #change to dataframe from tibble format
ken.pos <- subset(ken2, Site == "Kisii" | Site=="HomaBay") #subset to remove positive and negative controls before plotting
df <- dcast(ken.pos, Sample + Site + Host ~ Treatment, value.var="germ") #reformat data frame for easier plotting
colnames(df)[4] <- "DS" #ggplot didn't like column names that start with numbers
df$Site <- droplevels(df)$Site #get rid of unused levels for nicer legend
df <- subset(df, Sample != "Sther143") #only one replicate for one of the treatments
df <- subset(df, Sample != "Sther139") #less than 10 seeds in all wells for one of the treatments
####make plot
p1 <- ggplot(df, aes(x=DS, y=ORO, col=Site, pch = Host)) +
geom_point(size = 2.5, alpha = 0.8) +
geom_abline(intercept = 0, slope=1, lty=2) +
theme_classic() +
xlab("Germination % \n5DS") +
ylab("Germination % \nORO") +
scale_color_manual(values = paste0(jcolors(palette="pal5"))[c(2,4)], labels = c("Homa Bay", "Kisii")) +
scale_shape_discrete(labels = c("finger millet", "maize", "sorghum"))
# ken3
ken3 <- ken %>% group_by(Sample, Site, Host, Treatment)
ken3.pos <- subset(ken3, Site == "Kisii" | Site=="HomaBay") #subset to remove positive and negative controls before plotting
ken3.pos$Host <- as.factor(ken3.pos$Host)
ken3.pos$Treatment <- as.factor(ken3.pos$Treatment)
ken3.pos$Site <- as.factor(ken3.pos$Site)
# glmm with random effect of sample
library(lme4)
mod1 <- glmer(cbind(Germinated, Ungerminated) ~ Site + Host + Treatment + (1|Sample),
data = ken3.pos,
family = 'binomial')
mod2 <- glmer(cbind(Germinated, Ungerminated) ~ Site + Host  + (1|Sample),
data = ken3.pos,
family = 'binomial') # p = 0.004
mod3 <- glmer(cbind(Germinated, Ungerminated) ~ Treatment + Host  + (1|Sample),
data = ken3.pos,
family = 'binomial') # p = 0.011
mod4 <- glmer(cbind(Germinated, Ungerminated) ~ Site + Treatment  + (1|Sample),
data = ken3.pos,
family = 'binomial') # p = 0.24
####### keep treatment and site but not host
mod5 <- glmer(cbind(Germinated, Ungerminated) ~ Treatment  + (1|Sample),
data = ken3.pos,
family = 'binomial') # p = 0.05 to keep site
mod6 <- glmer(cbind(Germinated, Ungerminated) ~ Site + (1|Sample),
data = ken3.pos,
family = 'binomial') # p < 0.01 to keep treatment
summary(mod4)
?glmer
anova(mod5, mod6)
anova(mod5, mod6, test="Chisq")
